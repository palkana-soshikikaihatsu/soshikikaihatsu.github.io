/**
 * ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
 * ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰/ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆã‚’ç®¡ç†
 */

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ†ãƒ¼ãƒã‚’é©ç”¨
document.addEventListener('DOMContentLoaded', () => {
    // ä¿å­˜ã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’èª­ã¿è¾¼ã‚€
    const savedTheme = localStorage.getItem('ssap_theme') || 'light';
    applyTheme(savedTheme);

    // ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚’ä½œæˆ
    createThemeToggle();
});

/**
 * ãƒ†ãƒ¼ãƒã‚’é©ç”¨
 */
function applyTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('ssap_theme', theme);
    
    // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ›´æ–°
    updateToggleButton(theme);
}

/**
 * ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆ
 */
function toggleTheme() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    applyTheme(newTheme);
}

/**
 * ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚’ä½œæˆ
 */
function createThemeToggle() {
    const button = document.createElement('button');
    button.className = 'theme-toggle';
    button.setAttribute('aria-label', 'ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆ');
    button.onclick = toggleTheme;
    
    document.body.appendChild(button);
}

/**
 * ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ›´æ–°
 */
function updateToggleButton(theme) {
    const button = document.querySelector('.theme-toggle');
    if (!button) return;
    
    if (theme === 'dark') {
        button.innerHTML = 'â˜€ï¸'; // å¤ªé™½ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã¸ï¼‰
        button.setAttribute('title', 'ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ');
    } else {
        button.innerHTML = 'ğŸŒ™'; // æœˆã‚¢ã‚¤ã‚³ãƒ³ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¸ï¼‰
        button.setAttribute('title', 'ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ');
    }
}
